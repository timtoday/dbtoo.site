---
title:Delphi 写一个鼠标辅助工具
layout: post
tags:
- Delphi
- Win32
---
<div> <p>unit Unit1;</p><p>interface</p><p>uses<br/>Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,<br/>Dialogs, StdCtrls, ExtCtrls, ComCtrls, Menus, AppEvnts;<br/>type<br/>TForm1 = class(TForm)<br/>     ApplicationEvents1: TApplicationEvents;<br/>     Timer1: TTimer;<br/>     Button1: TButton;<br/>     TrackBar1: TTrackBar;<br/>     Label1: TLabel;<br/>     Button2: TButton;<br/>     HotKey1: THotKey;<br/>     RadioButton1: TRadioButton;<br/>     RadioButton2: TRadioButton;<br/>     procedure FormDestroy(Sender: TObject);<br/>     procedure Timer1Timer(Sender: TObject);<br/>     procedure TrackBar1Change(Sender: TObject);<br/>     procedure Button1Click(Sender: TObject);<br/>     procedure Button2Click(Sender: TObject);<br/>     procedure FormCreate(Sender: TObject);<br/>private<br/>     { Private declarations }<br/>public<br/>     { Public declarations }<br/>     procedure hotykey(var msg:TMessage); message WM_HOTKEY;<br/>     procedure worker();<br/>end;</p><p>var<br/>Form1: TForm1;<br/>id:Integer;<br/>s:bool;<br/>Key: word;<br/>ShiftState0: TShiftState;<br/>ShiftState: Cardinal;<br/>implementation</p><p>{$R *.dfm}<br/>procedure TForm1.worker();<br/>begin<br/>if RadioButton1.Checked=True then<br/>begin<br/>     //    left <br/>     mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0);<br/>     mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0);<br/>end;<br/>     if RadioButton2.Checked=True then<br/>begin<br/>     //     right<br/>     mouse_event(MOUSEEVENTF_RIGHTDOWN,0,0,0,0);<br/>     mouse_event(MOUSEEVENTF_RIGHTUP,0,0,0,0);<br/>end;<br/>end;</p><p>procedure TForm1.Button1Click(Sender: TObject);<br/>begin</p><p>ShortCutToKey(HotKey1.HotKey, Key, ShiftState0);<br/>ShiftState := 0;<br/>if (ssShift in ShiftState0) then<br/>     ShiftState := ShiftState or MOD_SHIFT;<br/>if (ssCtrl in ShiftState0) then<br/>     ShiftState := ShiftState or MOD_CONTROL;<br/>if (ssAlt in ShiftState0) then<br/>     ShiftState := ShiftState or MOD_ALT;<br/>id := GlobalAddAtom('MyHotKey') - $C000;<br/>RegisterHotKey(Handle, id, ShiftState, Key);</p><p>Button2.Enabled:= True;<br/>Button1.Enabled:= False;<br/>end;</p><p>procedure TForm1.Button2Click(Sender: TObject);<br/>begin <br/>Timer1.Enabled:= False;<br/>UnRegisterHotKey(handle,id);<br/>Button1.Enabled:= True;<br/>Button2.Enabled:= False;<br/>end;</p><p>procedure TForm1.FormCreate(Sender: TObject);<br/>begin<br/>     s:=False;<br/>end;</p><p>procedure TForm1.FormDestroy(Sender: TObject);<br/>begin<br/>UnRegisterHotKey(handle,id);<br/>end;</p><p>procedure TForm1.hotykey(var msg: TMessage);<br/>begin<br/>if (Msg.LparamLo = ShiftState) and (Msg.LParamHi = Key) then<br/>begin<br/>     if s=False then<br/>     begin<br/>      Timer1.Interval:= TrackBar1.Position;<br/>      s:=True;<br/>      Timer1.Enabled:= True;<br/>     end<br/>     else<br/>     begin<br/>       s:=False;<br/>       Timer1.Enabled:= False;<br/>     end;<br/>end; <br/>end;<br/>procedure TForm1.Timer1Timer(Sender: TObject);<br/>begin<br/>worker();<br/>end;</p><p>procedure TForm1.TrackBar1Change(Sender: TObject);<br/>begin<br/>Label1.Caption:= inttostr(TrackBar1.Position);<br/>end;</p><p>end.</p> </div>